[Unit]
Description=ETL AllpFit Analytics - Sincronização de Dados
Documentation=https://github.com/allpfit/analytics
After=network.target postgresql.service

[Service]
Type=oneshot
User=tester
Group=tester
WorkingDirectory=/home/tester/projetos/allpfit-analytics

# Executar script Python via venv
ExecStart=/home/tester/projetos/allpfit-analytics/venv/bin/python3 /home/tester/projetos/allpfit-analytics/src/multi_tenant/etl_v4/run_all_tenants.py

# Timeout de 30 minutos (para múltiplos tenants)
TimeoutSec=1800

# Restart em caso de falha
Restart=on-failure
RestartSec=300

# Logging
StandardOutput=journal
StandardError=journal
SyslogIdentifier=etl-allpfit

# Ambiente
Environment="PYTHONUNBUFFERED=1"
Environment="PATH=/home/tester/projetos/allpfit-analytics/venv/bin:/usr/local/bin:/usr/bin:/bin"

[Install]
WantedBy=multi-user.target